{
    "model_type": "gpt2",
    "architectures": [
        "GPT2LMHeadModel"
    ],
   "pre_weights" : [
	   {"name": "wte.weight",
	    "is_embed": true,
	    "output_space": "h.0"},

	   {"name":"wpe.weight",
	   "output_space": "h.0"}
  ],


  "layer_templates": {
	  "weights": [
		  { "name" :  "h.${layer_index}.ln_1.weight",
		    "input_space": "h.${layer_index}",
		    "output_space": "h.${layer_index}_1"
		  },
		  { "name" :  "h.${layer_index}.ln_1.bias",
		    "input_space": "h.${layer_index}_1",
		    "output_space": "h.${layer_index}_2"
		  },
		  { "name" :  "h.${layer_index}.attn.c_attn.weight",
		    "input_space": "h.${layer_index}_2",
		    "output_space": "h.${layer_index}_3"
		  },
		  { "name" :  "h.${layer_index}.attn.c_attn.bias",
		    "input_space": "h.${layer_index}_3",
		    "output_space": "h.${layer_index}_4"
		  },
		  { "name" :  "h.${layer_index}.attn.c_proj.weight",
		    "input_space": "h.${layer_index}_4",
		    "output_space": "h.${layer_index}_5"
		  },
		  { "name" :  "h.${layer_index}.attn.c_proj.bias",
		    "input_space": "h.${layer_index}_5",
		    "output_space": "h.${layer_index}_stop_gap"
		  },
		  {"name":  "h.${layer_index}.ln_2.weight",
		    "input_space": "h.${layer_index}_stop_gap",
		    "output_space": "h.${layer_index}_6"
		  },
		  {"name":  "h.${layer_index}.ln_2.bias",
		    "input_space": "h.${layer_index}_6",
		    "output_space": "h.${layer_index}_7"
		  },
		  {"name":  "h.${layer_index}.mlp.c_fc.weight",
		    "input_space": "h.${layer_index}_7",
		    "output_space": "h.${layer_index}_8"
		  },
		  {"name":  "h.${layer_index}.mlp.c_fc.bias",
		    "input_space": "h.${layer_index}_8",
		    "output_space": "h.${layer_index}_9"
		  },
		  {"name":  "h.${layer_index}.mlp.c_proj.weight",
		    "input_space": "h.${layer_index}_9",
		    "output_space": "h.${layer_index}_10"
		  },
		  {"name":  "h.${layer_index}.mlp.c_proj.bias",
		    "input_space": "h.${layer_index}_10",
		    "output_space": "h.${layer_index+1}"
		  }
	  ],


	  "procedural_spaces" : [
		{
            "name":"over_attention",
            "type": "residual",
            "inputs": ["h.${layer_index}", "h.${layer_index}_stop_gap"]
        },
		{
            "name":"over_mlp",
            "type" : "residual",
            "inputs": ["h.${layer_index}_stop_gap", "h.${layer_index+1}"]
        }
	  ]
  },

  "post_weights": [
	   {"name": "ln_f.weight",
	   "input_space": "h.${num_layers}",
	   "output_space": "ln_f_w_out"
	  },
	  {"name":"ln_f.bias",
	  "input_space": "ln_f_w_out"
	  }
	],

    "num_layers_config_key": "n_layer"


}
